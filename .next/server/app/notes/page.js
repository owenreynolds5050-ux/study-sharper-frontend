(()=>{var e={};e.id=151,e.ids=[151],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},2615:e=>{"use strict";e.exports=require("http")},5240:e=>{"use strict";e.exports=require("https")},8621:e=>{"use strict";e.exports=require("punycode")},6162:e=>{"use strict";e.exports=require("stream")},7360:e=>{"use strict";e.exports=require("url")},1568:e=>{"use strict";e.exports=require("zlib")},4442:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>o.Z,__next_app__:()=>u,originalPathname:()=>c,pages:()=>d,routeModule:()=>x,tree:()=>i}),t(524),t(5197),t(7629),t(1930),t(2523);var a=t(3191),s=t(8716),o=t(3315),n=t(5231),l={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>n[e]);t.d(r,l);let i=["",{children:["notes",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,524)),"C:\\Users\\owenr\\Desktop\\Windsurf Projects\\Study_Sharper_Complete\\Study_Sharper_Frontend\\src\\app\\notes\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,5197)),"C:\\Users\\owenr\\Desktop\\Windsurf Projects\\Study_Sharper_Complete\\Study_Sharper_Frontend\\src\\app\\layout.tsx"],error:[()=>Promise.resolve().then(t.bind(t,7629)),"C:\\Users\\owenr\\Desktop\\Windsurf Projects\\Study_Sharper_Complete\\Study_Sharper_Frontend\\src\\app\\error.tsx"],loading:[()=>Promise.resolve().then(t.bind(t,1930)),"C:\\Users\\owenr\\Desktop\\Windsurf Projects\\Study_Sharper_Complete\\Study_Sharper_Frontend\\src\\app\\loading.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,2523)),"C:\\Users\\owenr\\Desktop\\Windsurf Projects\\Study_Sharper_Complete\\Study_Sharper_Frontend\\src\\app\\not-found.tsx"]}],d=["C:\\Users\\owenr\\Desktop\\Windsurf Projects\\Study_Sharper_Complete\\Study_Sharper_Frontend\\src\\app\\notes\\page.tsx"],c="/notes/page",u={require:t,loadChunk:()=>Promise.resolve()},x=new a.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/notes/page",pathname:"/notes",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:i}})},1064:(e,r,t)=>{Promise.resolve().then(t.bind(t,338))},338:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>f});var a=t(326),s=t(7577),o=t(5047),n=t(5659),l=t(2777),i=t(454),d=t(2196),c=t(3835);function u({isOpen:e,fileName:r,fileSize:t,maxSize:s,onConfirm:o,onCancel:n}){if(!e)return null;let l=e=>{if(0===e)return"0 B";let r=Math.floor(Math.log(e)/Math.log(1024));return`${parseFloat((e/Math.pow(1024,r)).toFixed(2))} ${["B","KB","MB","GB"][r]}`};return a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",style:{top:0,left:0,right:0,bottom:0,position:"fixed"},children:(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4 p-6",children:[(0,a.jsxs)("div",{className:"flex items-start mb-4",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("svg",{className:"h-6 w-6 text-yellow-600 dark:text-yellow-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),a.jsx("div",{className:"ml-3 flex-1",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"File Too Large for AI Features"})})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("p",{className:"text-sm text-gray-700 dark:text-gray-300 mb-3",children:[a.jsx("span",{className:"font-medium",children:r})," is too large to be included in AI-powered Study Tools."]}),(0,a.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-3 mb-3",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"File size:"}),a.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:l(t)})]}),(0,a.jsxs)("div",{className:"flex justify-between text-sm mt-1",children:[a.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Maximum for AI:"}),a.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:l(s)})]})]}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Would you like to upload anyway for general note storage? You'll still be able to view the PDF, but AI features like text extraction and chat won't be available."})]}),(0,a.jsxs)("div",{className:"flex space-x-3",children:[a.jsx("button",{onClick:n,className:"flex-1 px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:"Cancel"}),a.jsx("button",{onClick:o,className:"flex-1 px-4 py-2 text-sm font-medium text-white bg-primary-600 rounded-lg hover:bg-primary-700 transition-colors",children:"Upload Anyway"})]})]})})}function x({x:e,y:r,onClose:t,onRename:o,onDelete:n}){let l=(0,s.useRef)(null);return(0,a.jsxs)("div",{ref:l,className:"fixed z-50 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg py-1 min-w-[160px]",style:{left:`${e}px`,top:`${r}px`},children:[(0,a.jsxs)("button",{onClick:()=>{o(),t()},className:"w-full px-4 py-2 text-left text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center space-x-2",children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5h2m2 0h2a2 2 0 012 2v2m0 2v2m0 2h-2m-2 0h-2m-2 0H9m-2 0H5a2 2 0 01-2-2v-2m0-2V7m0-2h2m2 0h2"})}),a.jsx("span",{children:"Rename Folder"})]}),a.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 my-1"}),(0,a.jsxs)("button",{onClick:()=>{n(),t()},className:"w-full px-4 py-2 text-left text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 flex items-center space-x-2",children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),a.jsx("span",{children:"Delete Folder"})]})]})}function m({isOpen:e,folders:r,onCancel:t,onSelectFolder:o,canCreateFolder:n,folderColors:l,onCreateFolder:i}){let d=(0,s.useRef)(null),[c,u]=(0,s.useState)(!1),[x,m]=(0,s.useState)(""),[g,p]=(0,s.useState)(l[0]??"#3b82f6"),[h,y]=(0,s.useState)(!1),[f,b]=(0,s.useState)(null),k=async()=>{if(i){if(!x.trim()){b("Folder name is required");return}y(!0),b(null);try{let e=await i(x.trim(),g);e&&(u(!1),m(""),o(e.id))}catch(e){b(e instanceof Error?e.message:"Failed to create folder")}finally{y(!1)}}};return e?a.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/60 p-4",style:{top:0,left:0,right:0,bottom:0,position:"fixed"},children:(0,a.jsxs)("div",{ref:d,className:"bg-white dark:bg-gray-800 rounded-xl shadow-xl max-w-md w-full p-6 border border-gray-200 dark:border-gray-700",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Choose upload folder"}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mb-4",children:"Where would you like to store the uploaded file?"}),n&&i&&a.jsx("div",{className:"mb-4",children:a.jsx("button",{onClick:()=>u(e=>!e),className:"text-sm font-medium text-primary-600 dark:text-primary-300 hover:underline",children:c?"Cancel new folder":"+ Create new folder"})}),c&&n&&i&&(0,a.jsxs)("div",{className:"mb-4 p-4 border border-gray-200 dark:border-gray-700 rounded-lg bg-gray-50 dark:bg-gray-700/40 space-y-3",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-gray-500 dark:text-gray-300 mb-2",children:"Folder name"}),a.jsx("input",{type:"text",value:x,onChange:e=>m(e.target.value),className:"w-full px-3 py-2 text-sm rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"e.g., Biology"})]}),(0,a.jsxs)("div",{children:[a.jsx("span",{className:"block text-xs font-semibold text-gray-500 dark:text-gray-300 mb-2",children:"Color"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:l.map(e=>a.jsx("button",{type:"button",onClick:()=>p(e),className:`w-7 h-7 rounded-full border-2 ${g===e?"border-gray-900 dark:border-white":"border-transparent"} focus:outline-none transition-transform hover:scale-105`,style:{backgroundColor:e},"aria-label":`Select ${e} color`},e))})]}),f&&a.jsx("p",{className:"text-xs text-red-500",children:f}),(0,a.jsxs)("div",{className:"flex justify-end space-x-2",children:[a.jsx("button",{onClick:()=>{u(!1),m(""),b(null)},className:"px-3 py-2 text-sm text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-gray-100",disabled:h,children:"Cancel"}),a.jsx("button",{onClick:k,disabled:h,className:"px-3 py-2 text-sm rounded-lg bg-primary-600 text-white hover:bg-primary-700 transition-colors disabled:opacity-60 disabled:cursor-not-allowed",children:h?"Creating...":"Create & use folder"})]})]}),!n&&a.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-3",children:"Folder limit reached. Delete an existing folder to add a new one."}),(0,a.jsxs)("div",{className:"space-y-2 max-h-64 overflow-y-auto pr-1",children:[(0,a.jsxs)("button",{onClick:()=>o(null),className:"w-full flex items-center px-3 py-2 rounded-lg border border-transparent hover:border-primary-200 hover:bg-primary-50 dark:hover:bg-primary-900/20 transition-colors",children:[a.jsx("span",{className:"w-3 h-3 rounded-full bg-gray-400 dark:bg-gray-500 mr-3"}),a.jsx("span",{className:"text-left text-sm text-gray-900 dark:text-gray-100",children:"All notes"})]}),r.map(e=>(0,a.jsxs)("button",{onClick:()=>o(e.id),className:"w-full flex items-center px-3 py-2 rounded-lg border border-transparent hover:border-primary-200 hover:bg-primary-50 dark:hover:bg-primary-900/20 transition-colors",children:[a.jsx("span",{className:"w-3 h-3 rounded-full mr-3",style:{backgroundColor:e.color}}),a.jsx("span",{className:"text-left text-sm text-gray-900 dark:text-gray-100",children:e.name})]},e.id))]}),a.jsx("div",{className:"mt-6 flex justify-end",children:a.jsx("button",{onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-gray-100",children:"Cancel"})})]})}):null}function g({messages:e,input:r,isLoading:t,onInputChange:o,onSendMessage:n,selectedNoteName:l}){let[i,d]=(0,s.useState)(!0),c=(0,s.useRef)(null),u=(0,s.useRef)(null);return(0,a.jsxs)("div",{className:`bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 flex flex-col transition-all duration-300 ${i?"w-96":"w-14"}`,children:[a.jsx("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:i?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center text-white text-lg mr-3",children:"\uD83E\uDD16"}),(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100",children:"AI Assistant"}),a.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:l?`Chatting about: ${l}`:"Ask me anything"})]})]}),a.jsx("button",{onClick:()=>d(!1),className:"p-1.5 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors","aria-label":"Collapse chat",children:a.jsx("svg",{className:"w-5 h-5 text-gray-600 dark:text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}):a.jsx("button",{onClick:()=>d(!0),className:"w-full p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors","aria-label":"Expand chat",children:a.jsx("div",{className:"text-2xl",children:"\uD83E\uDD16"})})}),i&&(0,a.jsxs)(a.Fragment,{children:[a.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 min-h-[400px] max-h-[600px]",children:0===e.length?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-center py-8",children:[a.jsx("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-purple-100 to-pink-100 dark:from-purple-900/20 dark:to-pink-900/20 flex items-center justify-center mb-4",children:a.jsx("span",{className:"text-3xl",children:"\uD83D\uDCA1"})}),a.jsx("h4",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 mb-2",children:"AI Study Assistant"}),a.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 max-w-xs",children:"Ask questions about your notes, get explanations, or request study tips!"}),(0,a.jsxs)("div",{className:"mt-4 space-y-2 w-full",children:[a.jsx("button",{onClick:()=>{o("Summarize my notes"),u.current?.focus()},className:"w-full text-left px-3 py-2 text-xs rounded-lg bg-gray-50 dark:bg-gray-700/50 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors text-gray-700 dark:text-gray-300",children:"\uD83D\uDCA1 Summarize my notes"}),a.jsx("button",{onClick:()=>{o("Create quiz questions"),u.current?.focus()},className:"w-full text-left px-3 py-2 text-xs rounded-lg bg-gray-50 dark:bg-gray-700/50 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors text-gray-700 dark:text-gray-300",children:"\uD83E\uDDE0 Create quiz questions"}),a.jsx("button",{onClick:()=>{o("Explain key concepts"),u.current?.focus()},className:"w-full text-left px-3 py-2 text-xs rounded-lg bg-gray-50 dark:bg-gray-700/50 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors text-gray-700 dark:text-gray-300",children:"\uD83D\uDCDA Explain key concepts"})]})]}):(0,a.jsxs)(a.Fragment,{children:[e.map(e=>a.jsx("div",{className:`flex ${"user"===e.type?"justify-end":"justify-start"}`,children:(0,a.jsxs)("div",{className:`max-w-[85%] rounded-lg px-4 py-2 ${"user"===e.type?"bg-gradient-to-br from-primary-500 to-primary-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-900 dark:text-gray-100"}`,children:[a.jsx("p",{className:"text-sm whitespace-pre-wrap",children:e.content}),e.sources&&e.sources.length>0&&(0,a.jsxs)("div",{className:"mt-2 pt-2 border-t border-gray-300 dark:border-gray-600",children:[a.jsx("p",{className:"text-xs opacity-75 mb-1",children:"Sources:"}),e.sources.map(e=>(0,a.jsxs)("div",{className:"text-xs opacity-75",children:["• ",e.title]},e.id))]}),a.jsx("div",{className:"text-xs opacity-75 mt-1",children:new Date(e.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})},e.id)),t&&a.jsx("div",{className:"flex justify-start",children:a.jsx("div",{className:"bg-gray-100 dark:bg-gray-700 rounded-lg px-4 py-3",children:(0,a.jsxs)("div",{className:"flex space-x-2",children:[a.jsx("div",{className:"w-2 h-2 bg-gray-400 dark:bg-gray-500 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),a.jsx("div",{className:"w-2 h-2 bg-gray-400 dark:bg-gray-500 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),a.jsx("div",{className:"w-2 h-2 bg-gray-400 dark:bg-gray-500 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})})}),a.jsx("div",{ref:c})]})}),(0,a.jsxs)("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700",children:[(0,a.jsxs)("div",{className:"flex items-end space-x-2",children:[a.jsx("textarea",{ref:u,value:r,onChange:e=>o(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),r.trim()&&!t&&n())},placeholder:"Ask anything...",rows:2,className:"flex-1 px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 resize-none",disabled:t}),a.jsx("button",{onClick:n,disabled:!r.trim()||t,className:"p-2.5 rounded-lg bg-gradient-to-br from-purple-500 to-pink-500 text-white hover:from-purple-600 hover:to-pink-600 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed shadow-sm","aria-label":"Send message",children:a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]}),a.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:"Press Enter to send, Shift+Enter for new line"})]})]})]})}let p=["#991b1b","#ef4444","#f97316","#eab308","#22c55e","#3b82f6","#a855f7","#ec4899","#92400e","#6b7280"],h=()=>"undefined"!=typeof crypto&&"function"==typeof crypto.randomUUID?crypto.randomUUID():`${Date.now()}-${Math.random().toString(16).slice(2)}`,y=async()=>{try{let{data:{session:e},error:r}=await l.O.auth.getSession();if(r)return console.error("[Notes] Session error:",r),null;return e?.access_token||null}catch(e){return console.error("[Notes] Failed to get session:",e),null}};function f(){let[e,r]=(0,s.useState)(!0),[t,f]=(0,s.useState)([]),[b,k]=(0,s.useState)(!0),[j,w]=(0,s.useState)(""),[v,N]=(0,s.useState)(null),[C,S]=(0,s.useState)([]),[D,_]=(0,s.useState)(null),[F,A]=(0,s.useState)("upload"),[$,O]=(0,s.useState)([]),[P,E]=(0,s.useState)(""),[L,z]=(0,s.useState)(!1),[U,M]=(0,s.useState)([]),[T,B]=(0,s.useState)(!1),[I,q]=(0,s.useState)([]),[W,R]=(0,s.useState)([]),[V,H]=(0,s.useState)(""),[J,K]=(0,s.useState)(""),[X,G]=(0,s.useState)(""),[Y,Q]=(0,s.useState)(!1),[Z,ee]=(0,s.useState)(null),[er,et]=(0,s.useState)(!1),[ea,es]=(0,s.useState)(null),[eo,en]=(0,s.useState)({isOpen:!1,noteId:null,noteTitle:""}),[el,ei]=(0,s.useState)(!1),[ed,ec]=(0,s.useState)({isOpen:!1,file:null,pendingUpload:null}),[eu,ex]=(0,s.useState)(!1),[em,eg]=(0,s.useState)(""),[ep,eh]=(0,s.useState)(p[0]),[ey,ef]=(0,s.useState)(!1),[eb,ek]=(0,s.useState)(null),[ej,ew]=(0,s.useState)({isOpen:!1,folder:null}),[ev,eN]=(0,s.useState)(null),[eC,eS]=(0,s.useState)(""),[eD,e_]=(0,s.useState)(!1),[eF,eA]=(0,s.useState)(!1),[e$,eO]=(0,s.useState)(!1),[eP,eE]=(0,s.useState)(!1),[eL,ez]=(0,s.useState)([]),eU=(0,o.useRouter)(),{user:eM,loading:eT}=(0,n.a)(),eB=(0,s.useRef)(null),eI=(0,s.useRef)(null),eq=C.length<10,eW=(0,s.useMemo)(()=>D?C.find(e=>e.id===D)??null:null,[C,D]),eR=(0,s.useCallback)(async e=>{console.log("[fetchFolders] Starting folder fetch for user:",e.id);try{let e=await y();if(!e)return console.warn("[fetchFolders] No session token available"),S([]),!0;console.log("[fetchFolders] Making request to /api/folders");let r=await fetch("/api/folders",{headers:{Authorization:`Bearer ${e}`}}).catch(e=>(console.warn("[fetchFolders] Fetch error:",e.message),null));if(!r)return console.warn("[fetchFolders] No response - backend may be down"),S([]),!0;if(console.log("[fetchFolders] Response status:",r.status),!r.ok){if(401===r.status)return console.error("[Notes] Unauthorized - redirecting to login"),eU.push("/auth/login?next=/notes"),!1;return console.warn("[fetchFolders] Non-OK response, using empty folders"),S([]),!0}let t=await r.json();return S(t||[]),_(e=>e?t?.some(r=>r.id===e)?e:null:e),C.length>=10&&ex(!1),!0}catch(e){return console.error("[fetchFolders] Error:",e),S([]),!0}},[eU,C.length]),eV=async e=>{if(eM){eO(!0);try{let{data:{session:r},error:t}=await l.O.auth.getSession();if(t||!r?.access_token)throw Error("Unauthorized");if(!(await fetch(`/api/folders/${e.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${r.access_token}`}})).ok)throw Error("Failed to delete folder");S(r=>r.filter(r=>r.id!==e.id)),D===e.id&&_(null),eu&&C.length-1<10&&ex(!1)}catch(e){console.error("Failed to delete folder:",e),alert("Failed to delete folder. Please try again.")}finally{eO(!1),ew({isOpen:!1,folder:null})}}},eH=(e,r)=>{e.preventDefault(),ek({x:e.clientX,y:e.clientY,folder:r})},eJ=e=>{eN(e.id),eS(e.name),e_(!0),eA(!1),ek(null),setTimeout(()=>{eB.current?.focus(),eB.current?.select()},0)},eK=()=>{eF||(eN(null),eS(""),e_(!1))},eX=async e=>{if(e?.preventDefault(),ev&&eC.trim()&&eM){eA(!0);try{let{data:{session:e},error:r}=await l.O.auth.getSession();if(r||!e?.access_token)throw Error("Unauthorized");let t=await fetch(`/api/folders/${ev}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e.access_token}`},body:JSON.stringify({name:eC.trim()})});if(!t.ok)throw Error("Folder rename failed");let a=await t.json();S(e=>e.map(e=>e.id===ev?a:e)),D===ev&&_(a.id),eK()}catch(e){console.error("Failed to rename folder:",e),alert("Failed to rename folder. Please try again.")}finally{eA(!1)}}},eG=(0,s.useCallback)(async e=>{console.log("[fetchNotes] Starting notes fetch for user:",e.id);try{let e=await y();if(!e)return console.warn("[fetchNotes] No session token available"),f([]),R([]),N(null),!0;console.log("[fetchNotes] Making request to /api/notes");let r=await fetch("/api/notes",{headers:{Authorization:`Bearer ${e}`}}).catch(e=>(console.warn("[fetchNotes] Fetch error:",e.message),null));if(!r)return console.warn("[fetchNotes] No response - backend may be down"),f([]),R([]),N(null),!0;if(console.log("[fetchNotes] Response status:",r.status),!r.ok){if(401===r.status)return console.error("[Notes] Unauthorized - redirecting to login"),eU.push("/auth/login?next=/notes"),!1;return console.warn("[fetchNotes] Non-OK response, using empty notes"),f([]),R([]),N(null),!0}let t=await r.json();f(t||[]),N(e=>e&&t?.some(r=>r.id===e.id)?e:t?.[0]??null);let a=new Set;return t?.forEach(e=>{e.tags?.forEach(e=>a.add(e))}),R(Array.from(a).sort()),!0}catch(e){return console.error("[fetchNotes] Error:",e),f([]),R([]),N(null),!0}},[eU]),eY=(0,s.useMemo)(()=>t.filter(e=>{let r=e.title.toLowerCase().includes(j.toLowerCase())||e.content&&e.content.toLowerCase().includes(j.toLowerCase())||e.tags&&e.tags.some(e=>e.toLowerCase().includes(j.toLowerCase())),t=0===I.length||e.tags&&I.every(r=>e.tags?.includes(r)),a=!D||e.folder_id===D;return r&&t&&a}),[t,j,I,D]),eQ=e=>{if(_(e),!e){N(e=>e&&t.some(r=>r.id===e.id)?e:t[0]??null);return}N(t.find(r=>r.folder_id===e)??null)},eZ=async()=>{if(eM&&em.trim()&&eq){if(C.some(e=>e.name.toLowerCase()===em.trim().toLowerCase())){alert(`A folder named "${em.trim()}" already exists. Please choose a different name.`);return}ef(!0);try{let{data:{session:e},error:r}=await l.O.auth.getSession();if(r||!e?.access_token)throw Error("Unauthorized");let t=await fetch("/api/folders",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e.access_token}`},body:JSON.stringify({name:em.trim(),color:ep})});if(!t.ok)throw Error("Failed to create folder");let a=await t.json();S(e=>[...e,a]),ex(!1),eg(""),eh(p[0]),_(a.id)}catch(e){console.error("Error creating folder:",e),alert("Failed to create folder. Please try again.")}finally{ef(!1)}}},e0=async(e,r)=>{if(!eM||!e.trim()||!eq)return null;if(C.some(r=>r.name.toLowerCase()===e.trim().toLowerCase()))return alert(`A folder named "${e.trim()}" already exists. Please choose a different name.`),null;try{let{data:{session:t},error:a}=await l.O.auth.getSession();if(a||!t?.access_token)throw Error("Unauthorized");let s=await fetch("/api/folders",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t.access_token}`},body:JSON.stringify({name:e.trim(),color:r})});if(!s.ok)return null;let o=await s.json();return S(e=>[...e,o]),{id:o.id,name:o.name,color:o.color}}catch(e){return console.error("Upload create folder error:",e),null}},e2=e=>{0!==e.length&&(ez(e),eE(!0))},e1=async(e,r)=>{if(0===e.length)return;let{data:{session:a},error:s}=await l.O.auth.getSession();if(s||!a?.access_token){console.error("No active session found for upload",s),alert("Your session has expired. Please sign in again to upload files.");return}let o=a.access_token,n=r??null;for(let r=0;r<e.length;r++){let a=e[r],s=a.name.replace(/\.(pdf|docx)$/i,"");if(!t.some(e=>e.title===s&&(!n||e.folder_id===n))||confirm(`A file named "${s}" already exists${n?" in this folder":""}. Do you want to upload it anyway?`)){if(!["application/pdf","application/vnd.openxmlformats-officedocument.wordprocessingml.document"].includes(a.type)){alert(`${a.name} is not supported. Only PDF and DOCX files are currently supported.`);continue}if(a.size>1048576){await new Promise(e=>{ec({isOpen:!0,file:a,pendingUpload:()=>{ec({isOpen:!1,file:null,pendingUpload:null}),e3(a,o,r,!0,n),e()}})});continue}await e3(a,o,r,!1,n)}}},e3=async(e,r,t,a,s)=>{let o={id:Date.now().toString()+t,name:e.name,type:e.type,size:e.size,url:URL.createObjectURL(e),status:"uploading"};M(e=>[...e,o]);try{let t=new FormData;t.append("file",e),t.append("title",e.name.replace(/\.(pdf|docx)$/i,"")),a&&t.append("skipAI","true"),s&&t.append("folder_id",s);let n=await fetch("/api/notes/upload",{method:"POST",body:t,credentials:"include",headers:{Authorization:`Bearer ${r}`}}),l=null;if(n.headers.get("content-type")?.includes("application/json"))try{l=await n.json()}catch(e){console.error("Failed to parse upload response as JSON",e)}if(!n.ok){let e=l?.error||`Upload failed (status ${n.status})`;throw Error(e)}M(e=>e.map(e=>e.id===o.id?{...e,status:"completed",summary:"File uploaded and text extracted successfully!"}:e)),eM&&await eG(eM),setTimeout(()=>{M(e=>e.filter(e=>e.id!==o.id))},2e3)}catch(r){console.error("Upload error:",r),M(e=>e.map(e=>e.id===o.id?{...e,status:"error"}:e)),alert(`Failed to upload ${e.name}: ${r instanceof Error?r.message:"Unknown error"}`)}},e4=async()=>{if(eM&&V.trim()){Q(!0);try{let e=X.split(",").map(e=>e.trim()).filter(e=>e.length>0),{data:{session:r},error:t}=await l.O.auth.getSession();if(t||!r?.access_token)throw Error("Unauthorized");let a=await fetch("/api/notes",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r.access_token}`},body:JSON.stringify({title:V.trim(),content:J.trim()||null,tags:e.length>0?e:null,folder_id:D??null})});if(!a.ok){let e=await a.text();throw console.error("[createNote] API error:",a.status,e),Error(`Failed to create note: ${a.status} - ${e}`)}let s=await a.json();H(""),K(""),G(""),await eG(eM),s&&N(s)}catch(r){console.error("Error creating note:",r);let e=r instanceof Error?r.message:"Unknown error";e.includes("Failed to fetch")||e.includes("NetworkError")?alert("Cannot connect to backend server. Please ensure the backend is running at http://127.0.0.1:8000"):alert(`Failed to create note: ${e}`)}finally{Q(!1)}}},e5=e=>{ee(e),et(!0)},e7=(e,r)=>{e.preventDefault(),es({x:e.clientX,y:e.clientY,noteId:r})},e6=async(e,r)=>{if(!eM)return;let a=t.find(r=>r.id===e);if(!a||a.folder_id===r){es(null);return}try{let{data:{session:t},error:a}=await l.O.auth.getSession();if(a||!t?.access_token)throw Error("Unauthorized");if(!(await fetch(`/api/notes/${e}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t.access_token}`},body:JSON.stringify({folder_id:r})})).ok)throw Error("Failed to move note");f(t=>t.map(t=>t.id===e?{...t,folder_id:r}:t)),N(t=>t&&t.id===e?{...t,folder_id:r}:t),ee(t=>t&&t.id===e?{...t,folder_id:r}:t),D&&r!==D&&N(r=>r&&r.id===e?null:r),es(null),eM&&eR(eM)}catch(e){console.error("Failed to move note:",e),alert("Failed to move note. Please try again.")}},e9=e=>{let r=t.find(r=>r.id===e);r&&(en({isOpen:!0,noteId:e,noteTitle:r.title}),es(null))},e8=async()=>{if(eo.noteId&&eM){ei(!0);try{let{data:{session:e},error:r}=await l.O.auth.getSession();if(r||!e?.access_token)throw Error("Unauthorized");if(!(await fetch(`/api/notes/${eo.noteId}`,{method:"DELETE",headers:{Authorization:`Bearer ${e.access_token}`}})).ok)throw Error("Delete failed");Z?.id===eo.noteId&&(et(!1),ee(null)),await eG(eM),en({isOpen:!1,noteId:null,noteTitle:""})}catch(e){console.error("Delete failed:",e),alert("Failed to delete note. Please try again.")}finally{ei(!1)}}},re=async()=>{if(!P.trim()||L)return;let e={id:h(),type:"user",content:P,timestamp:new Date().toISOString(),noteId:v?.id},r=[...$,e].map(e=>({role:"user"===e.type?"user":"assistant",content:e.content}));O(r=>[...r,e]),E(""),z(!0);try{let{data:{session:e},error:t}=await l.O.auth.getSession();if(t||!e?.access_token)throw Error("You must be signed in to use the AI assistant. Please log in again.");let a=await fetch("/api/notes/chat",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e.access_token}`},credentials:"include",body:JSON.stringify({messages:r,noteIds:v?[v.id]:void 0})}),s=await a.json().catch(()=>null);if(!a.ok)throw Error(s?.error??"Chat request failed");let o={id:h(),type:"ai",content:s?.message??"No response generated.",timestamp:new Date().toISOString(),noteId:v?.id,sources:Array.isArray(s?.sources)?s.sources:void 0};O(e=>[...e,o])}catch(r){console.error("Chat error:",r);let e={id:h(),type:"ai",content:r instanceof Error?r.message:"Failed to generate response. Please try again.",timestamp:new Date().toISOString(),noteId:v?.id};O(r=>[...r,e])}finally{z(!1)}},rr=e=>e.includes("pdf")?"\uD83D\uDCC4":e.includes("audio")?"\uD83C\uDFB5":e.includes("image")?"\uD83D\uDDBC️":e.includes("video")?"\uD83C\uDFA5":"\uD83D\uDCC4",rt=e=>{switch(e){case"completed":return"text-green-600";case"processing":return"text-yellow-600";case"uploading":return"text-blue-600";case"error":return"text-red-600";default:return"text-gray-600"}},ra=e=>{if(!e)return"N/A";try{let r=new Date(e);if(isNaN(r.getTime()))return"N/A";return r.toLocaleDateString()}catch{return"N/A"}};return b?a.jsx("div",{className:"flex items-center justify-center min-h-96",children:a.jsx("div",{className:"text-lg",children:"Loading notes..."})}):(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100",children:"Notes"}),a.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"Create, manage, and organize your study notes"}),!e&&(0,a.jsxs)("div",{className:"mt-3 inline-flex items-center space-x-2 rounded-full bg-primary-50 text-primary-700 px-3 py-1 text-xs font-medium dark:bg-primary-900/30 dark:text-primary-200",children:[a.jsx("span",{className:"inline-flex h-2.5 w-2.5 rounded-full border border-primary-200 dark:border-primary-700",style:{backgroundColor:eW?.color??"#9ca3af"}}),(0,a.jsxs)("span",{children:["Viewing: ",eW?.name??"All notes"]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[a.jsx("button",{onClick:()=>eI.current?.click(),className:"bg-primary-600 text-white px-4 py-2 rounded-lg hover:bg-primary-700 transition-colors",children:"Upload Files"}),a.jsx("button",{className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors",onClick:()=>{_(null),r(!0),window.scrollTo({top:0,behavior:"smooth"})},children:"Create Note"}),a.jsx("input",{type:"file",multiple:!0,ref:eI,className:"hidden",accept:".pdf,.docx",onChange:e=>{let{files:r}=e.target;r&&0!==r.length&&(e2(Array.from(r)),e.target.value="")}})]})]}),(0,a.jsxs)("div",{className:"flex pt-6 gap-6",children:[(0,a.jsxs)("div",{className:`${e?"w-80":"w-12"} bg-white dark:bg-gray-800 shadow-lg rounded-xl transition-all duration-300 flex flex-col border border-gray-200 dark:border-gray-700`,children:[(0,a.jsxs)("div",{className:`p-2 border-b border-gray-200 dark:border-gray-700 flex items-center ${e?"justify-between pl-2 pr-2":"justify-center"}`,children:[a.jsx("h2",{className:`font-semibold text-gray-900 dark:text-gray-100 ${e?"pl-1":"hidden"}`,children:"Saved Notes"}),a.jsx("button",{onClick:()=>r(!e),className:`rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors ${e?"p-2":"p-3"}`,title:e?"Collapse sidebar":"Expand sidebar",children:a.jsx("svg",{className:"w-5 h-5 text-gray-600 dark:text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e?a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 19l-7-7 7-7m8 14l-7-7 7-7"}):a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 5l7 7-7 7M5 5l7 7-7 7"})})})]}),e&&(0,a.jsxs)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide text-gray-500 dark:text-gray-400",children:"Folders"}),(0,a.jsxs)("button",{onClick:()=>{eq&&ex(e=>!e)},disabled:!eq,className:`inline-flex items-center px-2 py-1 text-xs font-medium rounded-md transition-colors relative group ${eq?"text-primary-600 dark:text-primary-300 bg-primary-50 dark:bg-primary-900/20 hover:bg-primary-100 dark:hover:bg-primary-900/40":"text-gray-400 dark:text-gray-500 bg-gray-100 dark:bg-gray-700 cursor-not-allowed"}`,children:[eu?"Cancel":"+ New",!eq&&a.jsx("span",{className:"pointer-events-none absolute left-1/2 top-full mt-2 -translate-x-1/2 whitespace-nowrap rounded bg-gray-800 px-2 py-1 text-[10px] font-medium text-white opacity-0 group-hover:opacity-100 transition-opacity",children:"Folder limit reached. Delete an existing folder to add a new one."})]})]}),eu&&eq&&(0,a.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700/40 border border-gray-200 dark:border-gray-600 rounded-lg p-3 space-y-3",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-gray-600 dark:text-gray-300 mb-2",children:"Folder name"}),a.jsx("input",{type:"text",value:em,onChange:e=>eg(e.target.value),placeholder:"e.g. Biology",className:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100"})]}),(0,a.jsxs)("div",{children:[a.jsx("span",{className:"block text-xs font-semibold text-gray-600 dark:text-gray-300 mb-2",children:"Color"}),a.jsx("div",{className:"grid grid-cols-5 gap-2",children:p.map(e=>a.jsx("button",{type:"button",onClick:()=>eh(e),className:`w-7 h-7 rounded-full border-2 ${ep===e?"border-gray-900 dark:border-white":"border-transparent"} focus:outline-none transition-transform hover:scale-105`,style:{backgroundColor:e},"aria-label":`Select ${e} color`},e))})]}),a.jsx("button",{onClick:eZ,disabled:ey||0===em.trim().length,className:"w-full inline-flex items-center justify-center px-3 py-2 text-sm font-medium rounded-lg bg-primary-600 text-white hover:bg-primary-700 transition-colors disabled:opacity-60 disabled:cursor-not-allowed",children:ey?"Creating...":"Create folder"})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("button",{onClick:()=>eQ(null),className:`w-full flex items-center px-3 py-2 rounded-lg text-sm transition-colors ${null===D?"bg-primary-100 dark:bg-primary-900/30 text-primary-700 dark:text-primary-200":"hover:bg-gray-100 dark:hover:bg-gray-700/50 text-gray-700 dark:text-gray-200"}`,children:[a.jsx("span",{className:"w-2.5 h-2.5 rounded-full bg-gray-400 dark:bg-gray-500 mr-3"}),a.jsx("span",{className:"flex-1 text-left",children:"All notes"})]}),0===C.length&&!eu&&a.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 px-1 py-2",children:"No folders yet. Create one to get started."}),C.map(e=>ev===e.id?(0,a.jsxs)("form",{onSubmit:eX,className:"w-full px-3 py-2 rounded-lg bg-primary-50 dark:bg-primary-900/20 border border-primary-200 dark:border-primary-700 space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"w-2.5 h-2.5 rounded-full",style:{backgroundColor:e.color}}),a.jsx("input",{ref:eB,value:eC,onChange:e=>eS(e.target.value),onKeyDown:e=>{"Escape"===e.key&&eK()},className:"flex-1 bg-transparent border border-gray-300 dark:border-gray-600 rounded-lg px-2 py-1 text-sm text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Folder name",disabled:eF})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-2",children:[a.jsx("button",{type:"button",onClick:eK,className:"px-2 py-1 text-xs text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-gray-100",disabled:eF,children:"Cancel"}),a.jsx("button",{type:"submit",className:"px-3 py-1 text-xs rounded-lg bg-primary-600 text-white hover:bg-primary-700 transition-colors disabled:opacity-60 disabled:cursor-not-allowed",disabled:eF||0===eC.trim().length,children:eF?"Saving...":"Save"})]})]},e.id):(0,a.jsxs)("button",{onClick:()=>eQ(e.id),onContextMenu:r=>eH(r,e),className:`w-full flex items-center px-3 py-2 rounded-lg text-sm transition-colors ${D===e.id?"bg-primary-100 dark:bg-primary-900/30 text-primary-700 dark:text-primary-200":"hover:bg-gray-100 dark:hover:bg-gray-700/50 text-gray-700 dark:text-gray-200"}`,children:[a.jsx("span",{className:"w-2.5 h-2.5 rounded-full mr-3",style:{backgroundColor:e.color}}),a.jsx("span",{className:"flex-1 text-left truncate",children:e.name}),D===e.id&&a.jsx("svg",{className:"w-4 h-4 text-primary-600 dark:text-primary-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})]},e.id))]})]}),e&&a.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:a.jsx("input",{type:"text",placeholder:"Search notes...",className:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",value:j,onChange:e=>w(e.target.value)})}),a.jsx("div",{className:`flex-1 overflow-y-auto ${!e&&"hidden"}`,children:0===eY.length?a.jsx("div",{className:"p-4 text-center text-gray-500 dark:text-gray-400",children:e?(0,a.jsxs)("div",{children:[a.jsx("svg",{className:"mx-auto h-8 w-8 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),a.jsx("p",{className:"text-sm",children:"No notes yet"})]}):a.jsx("svg",{className:"mx-auto h-8 w-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}):a.jsx("div",{className:"p-2",children:eY.map(r=>{let t=r.folder_id?C.find(e=>e.id===r.folder_id)?.color??"#9ca3af":null;return(0,a.jsxs)("div",{onClick:()=>e5(r),onContextMenu:e=>e7(e,r.id),className:`p-3 rounded-lg cursor-pointer transition-all duration-200 mb-2 ${v?.id===r.id?"bg-primary-50 dark:bg-primary-900/20 border border-primary-200 dark:border-primary-700 shadow-sm":"hover:bg-gray-50 dark:hover:bg-gray-700/30 hover:shadow-sm"}`,children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[t&&a.jsx("span",{className:"inline-flex h-2.5 w-2.5 rounded-full border border-gray-200 dark:border-gray-600",style:{backgroundColor:t},"aria-hidden":!0}),a.jsx("h3",{className:`font-medium text-gray-900 dark:text-gray-100 line-clamp-1 ${!e&&"hidden"}`,children:r.title})]}),a.jsx("p",{className:`text-sm text-gray-600 dark:text-gray-300 line-clamp-2 mt-1 ${!e&&"hidden"}`,children:r.content}),a.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:ra(r.updated_at)})]},r.id)})})})]}),(0,a.jsxs)("div",{className:"flex-1 space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Recent Files"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[eY.slice(0,4).map(e=>(0,a.jsxs)("div",{className:"p-4 border border-gray-200 dark:border-gray-600 rounded-lg hover:shadow-md hover:-translate-y-1 transition-all duration-200 cursor-pointer",onClick:()=>e5(e),onContextMenu:r=>e7(r,e.id),children:[(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[a.jsx("svg",{className:"w-5 h-5 text-gray-400 dark:text-gray-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),a.jsx("h3",{className:"font-medium text-gray-900 dark:text-gray-100 line-clamp-1",children:e.title})]}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 line-clamp-2",children:e.content}),a.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:ra(e.updated_at)})]},e.id)),0===eY.length&&(0,a.jsxs)("div",{className:"col-span-full text-center py-8 text-gray-500 dark:text-gray-400",children:[a.jsx("svg",{className:"mx-auto h-12 w-12 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),a.jsx("p",{children:"No recent files"})]})]})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[a.jsx("div",{className:"flex items-center justify-between mb-4",children:(0,a.jsxs)("div",{children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Upload Files"}),a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Upload PDF or DOCX files for AI-powered processing"})]})}),(0,a.jsxs)("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-8 text-center hover:border-primary-400 dark:hover:border-primary-500 transition-colors",onDragOver:e=>e.preventDefault(),onDrop:e=>{e.preventDefault(),e.dataTransfer.files&&e2(Array.from(e.dataTransfer.files))},children:[a.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),a.jsx("p",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:"Drop files here or click to upload"}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mb-4",children:"Automatic text extraction, summarization, and smart tagging"}),a.jsx("div",{className:"flex justify-center space-x-4",children:(0,a.jsxs)("label",{className:"bg-gradient-to-br from-primary-600 to-primary-700 text-white px-6 py-3 rounded-lg hover:from-primary-700 hover:to-primary-800 transition-all duration-200 cursor-pointer shadow-md hover:shadow-lg",children:["Choose Files",a.jsx("input",{type:"file",multiple:!0,className:"hidden",accept:".pdf,.docx",onChange:e=>{e.target.files&&(e2(Array.from(e.target.files)),e.target.value="")}})]})}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-4",children:[a.jsx("p",{className:"font-medium mb-1",children:"PDF & DOCX files • Max 10MB"}),a.jsx("p",{className:"text-yellow-600 dark:text-yellow-400",children:"⚠️ Files under 1MB recommended for AI features"}),a.jsx("p",{className:"mt-2",children:"\uD83D\uDCC4 Text extraction • \uD83D\uDD0D AI-powered search • \uD83C\uDFF7️ Smart organization"})]})]}),U.length>0&&(0,a.jsxs)("div",{className:"mt-6",children:[a.jsx("h3",{className:"font-medium text-gray-900 dark:text-gray-100 mb-3",children:"Processing Queue"}),a.jsx("div",{className:"space-y-2",children:U.map(e=>(0,a.jsxs)("div",{className:"flex items-center p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[a.jsx("div",{className:"text-xl mr-3",children:rr(e.type)}),(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100",children:e.name}),a.jsx("div",{className:`text-xs ${rt(e.status)}`,children:"completed"===e.status?"✅ AI Processing Complete":"\uD83E\uDD16 Processing..."})]})]},e.id))})]})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Create Notes Manually"}),a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Craft a new note by hand and save it to your collection"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[a.jsx("button",{onClick:()=>{H(""),K("")},className:"px-3 py-2 text-sm rounded-lg border border-gray-200 dark:border-gray-600 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:"Clear"}),a.jsx("button",{onClick:e4,disabled:!V.trim()||Y,className:"px-4 py-2 text-sm rounded-lg bg-green-600 text-white hover:bg-green-700 transition-colors disabled:opacity-60 disabled:cursor-not-allowed shadow-sm",children:Y?"Saving...":"Save Note"})]})]}),(0,a.jsxs)("div",{className:"space-y-4 max-w-3xl",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Note Title"}),a.jsx("input",{type:"text",value:V,onChange:e=>H(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",placeholder:"Enter note title..."})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Content"}),a.jsx("textarea",{rows:8,value:J,onChange:e=>K(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",placeholder:"Write your note content here..."})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Assign to folder"}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[a.jsx("button",{type:"button",onClick:()=>_(null),className:`px-3 py-1.5 text-sm rounded-full border ${null===D?"border-primary-500 bg-primary-50 text-primary-600 dark:bg-primary-900/20 dark:text-primary-200":"border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-300 hover:border-primary-400"}`,children:"All notes"}),C.map(e=>a.jsx("button",{type:"button",onClick:()=>_(e.id),className:`px-3 py-1.5 text-sm rounded-full border ${D===e.id?"border-primary-500 bg-primary-50 text-primary-600 dark:bg-primary-900/20 dark:text-primary-200":"border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-300 hover:border-primary-400"}`,children:(0,a.jsxs)("span",{className:"inline-flex items-center space-x-2",children:[a.jsx("span",{className:"inline-block w-2.5 h-2.5 rounded-full",style:{backgroundColor:e.color}}),a.jsx("span",{children:e.name})]})},e.id))]})]})]})]})]}),a.jsx(g,{messages:$,input:P,isLoading:L,onInputChange:E,onSendMessage:re,selectedNoteName:v?.title})]}),a.jsx(m,{isOpen:eP,folders:C.map(e=>({id:e.id,name:e.name,color:e.color})),onCancel:()=>{eE(!1),ez([])},onSelectFolder:e=>{if(0===eL.length){eE(!1);return}e1(eL,e),eE(!1),ez([])},canCreateFolder:C.length<10,folderColors:p,onCreateFolder:C.length<10?e0:void 0}),eb&&a.jsx(x,{x:eb.x,y:eb.y,onClose:()=>ek(null),onRename:()=>eJ(eb.folder),onDelete:()=>{ew({isOpen:!0,folder:eb.folder}),ek(null)}}),a.jsx(c.Q,{isOpen:ej.isOpen,title:"Delete Folder",message:ej.folder?`Are you sure you want to delete the folder "${ej.folder.name}"? Notes inside will remain accessible under All notes.`:"",confirmText:e$?"Deleting...":"Delete",cancelText:"Cancel",onConfirm:()=>{ej.folder&&eV(ej.folder)},onCancel:()=>{e$||ew({isOpen:!1,folder:null})},isDestructive:!0}),a.jsx(i.t,{note:Z,isOpen:er,onClose:()=>{et(!1),ee(null)},onDeleted:()=>{et(!1),ee(null),eM&&(eG(eM),eR(eM))},folders:C,onUpdated:e=>{f(r=>r.map(r=>r.id===e.id?{...r,folder_id:e.folder_id}:r)),ee(r=>r&&r.id===e.id?{...r,folder_id:e.folder_id}:r),D&&e.folder_id!==D&&N(r=>r&&r.id===e.id?null:r),eM&&(eG(eM),eR(eM))}}),ea&&a.jsx(d.L,{x:ea.x,y:ea.y,onDelete:()=>e9(ea.noteId),onClose:()=>es(null),folders:C,currentFolderId:t.find(e=>e.id===ea.noteId)?.folder_id??null,onMove:e=>e6(ea.noteId,e)}),a.jsx(c.Q,{isOpen:eo.isOpen,title:"Delete note?",message:`Are you sure you want to delete "${eo.noteTitle}"? This action cannot be undone.`,confirmText:el?"Deleting...":"Delete",cancelText:"Cancel",onConfirm:e8,onCancel:()=>en({isOpen:!1,noteId:null,noteTitle:""}),isDestructive:!0}),a.jsx(u,{isOpen:ed.isOpen,fileName:ed.file?.name??"",fileSize:ed.file?.size??0,maxSize:1048576,onConfirm:()=>{ed.pendingUpload&&ed.pendingUpload()},onCancel:()=>{ec({isOpen:!1,file:null,pendingUpload:null})}})]})}},524:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>a});let a=(0,t(8570).createProxy)(String.raw`C:\Users\owenr\Desktop\Windsurf Projects\Study_Sharper_Complete\Study_Sharper_Frontend\src\app\notes\page.tsx#default`)}};var r=require("../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[276,688,819,644],()=>t(4442));module.exports=a})();