(()=>{var e={};e.id=151,e.ids=[151],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},2615:e=>{"use strict";e.exports=require("http")},8791:e=>{"use strict";e.exports=require("https")},8621:e=>{"use strict";e.exports=require("punycode")},6162:e=>{"use strict";e.exports=require("stream")},7360:e=>{"use strict";e.exports=require("url")},1568:e=>{"use strict";e.exports=require("zlib")},4442:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>o.Z,__next_app__:()=>x,originalPathname:()=>c,pages:()=>d,routeModule:()=>u,tree:()=>i}),t(524),t(5534),t(7629),t(1930),t(2523);var a=t(3191),s=t(8716),o=t(3315),l=t(5231),n={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>l[e]);t.d(r,n);let i=["",{children:["notes",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,524)),"C:\\Users\\owenr\\Desktop\\Windsurf Projects\\Study_Sharper_Complete\\Study_Sharper_Frontend\\src\\app\\notes\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,5534)),"C:\\Users\\owenr\\Desktop\\Windsurf Projects\\Study_Sharper_Complete\\Study_Sharper_Frontend\\src\\app\\layout.tsx"],error:[()=>Promise.resolve().then(t.bind(t,7629)),"C:\\Users\\owenr\\Desktop\\Windsurf Projects\\Study_Sharper_Complete\\Study_Sharper_Frontend\\src\\app\\error.tsx"],loading:[()=>Promise.resolve().then(t.bind(t,1930)),"C:\\Users\\owenr\\Desktop\\Windsurf Projects\\Study_Sharper_Complete\\Study_Sharper_Frontend\\src\\app\\loading.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,2523)),"C:\\Users\\owenr\\Desktop\\Windsurf Projects\\Study_Sharper_Complete\\Study_Sharper_Frontend\\src\\app\\not-found.tsx"]}],d=["C:\\Users\\owenr\\Desktop\\Windsurf Projects\\Study_Sharper_Complete\\Study_Sharper_Frontend\\src\\app\\notes\\page.tsx"],c="/notes/page",x={require:t,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/notes/page",pathname:"/notes",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:i}})},1064:(e,r,t)=>{Promise.resolve().then(t.bind(t,5896))},5896:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>y});var a=t(326),s=t(7577),o=t(5047),l=t(2567),n=t(2777),i=t(8492),d=t(9574),c=t(6413);function x({isOpen:e,fileName:r,fileSize:t,maxSize:s,onConfirm:o,onCancel:l}){if(!e)return null;let n=e=>{if(0===e)return"0 B";let r=Math.floor(Math.log(e)/Math.log(1024));return`${parseFloat((e/Math.pow(1024,r)).toFixed(2))} ${["B","KB","MB","GB"][r]}`};return a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4 p-6",children:[(0,a.jsxs)("div",{className:"flex items-start mb-4",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("svg",{className:"h-6 w-6 text-yellow-600 dark:text-yellow-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),a.jsx("div",{className:"ml-3 flex-1",children:a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"File Too Large for AI Features"})})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("p",{className:"text-sm text-gray-700 dark:text-gray-300 mb-3",children:[a.jsx("span",{className:"font-medium",children:r})," is too large to be included in AI-powered Study Tools."]}),(0,a.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-3 mb-3",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"File size:"}),a.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:n(t)})]}),(0,a.jsxs)("div",{className:"flex justify-between text-sm mt-1",children:[a.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Maximum for AI:"}),a.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:n(s)})]})]}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Would you like to upload anyway for general note storage? You'll still be able to view the PDF, but AI features like text extraction and chat won't be available."})]}),(0,a.jsxs)("div",{className:"flex space-x-3",children:[a.jsx("button",{onClick:l,className:"flex-1 px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:"Cancel"}),a.jsx("button",{onClick:o,className:"flex-1 px-4 py-2 text-sm font-medium text-white bg-primary-600 rounded-lg hover:bg-primary-700 transition-colors",children:"Upload Anyway"})]})]})})}function u({x:e,y:r,onClose:t,onRename:o,onDelete:l}){let n=(0,s.useRef)(null);return(0,a.jsxs)("div",{ref:n,className:"fixed z-50 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg py-1 min-w-[160px]",style:{left:`${e}px`,top:`${r}px`},children:[(0,a.jsxs)("button",{onClick:()=>{o(),t()},className:"w-full px-4 py-2 text-left text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center space-x-2",children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5h2m2 0h2a2 2 0 012 2v2m0 2v2m0 2h-2m-2 0h-2m-2 0H9m-2 0H5a2 2 0 01-2-2v-2m0-2V7m0-2h2m2 0h2"})}),a.jsx("span",{children:"Rename Folder"})]}),a.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 my-1"}),(0,a.jsxs)("button",{onClick:()=>{l(),t()},className:"w-full px-4 py-2 text-left text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 flex items-center space-x-2",children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),a.jsx("span",{children:"Delete Folder"})]})]})}function m({isOpen:e,folders:r,onCancel:t,onSelectFolder:o,canCreateFolder:l,folderColors:n,onCreateFolder:i}){let d=(0,s.useRef)(null),[c,x]=(0,s.useState)(!1),[u,m]=(0,s.useState)(""),[g,p]=(0,s.useState)(n[0]??"#3b82f6"),[y,h]=(0,s.useState)(!1),[f,b]=(0,s.useState)(null),k=async()=>{if(i){if(!u.trim()){b("Folder name is required");return}h(!0),b(null);try{let e=await i(u.trim(),g);e&&(x(!1),m(""),o(e.id))}catch(e){b(e instanceof Error?e.message:"Failed to create folder")}finally{h(!1)}}};return e?a.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/60 p-4",children:(0,a.jsxs)("div",{ref:d,className:"bg-white dark:bg-gray-800 rounded-xl shadow-xl max-w-md w-full p-6 border border-gray-200 dark:border-gray-700",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Choose upload folder"}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mb-4",children:"Where would you like to store the uploaded file?"}),l&&i&&a.jsx("div",{className:"mb-4",children:a.jsx("button",{onClick:()=>x(e=>!e),className:"text-sm font-medium text-primary-600 dark:text-primary-300 hover:underline",children:c?"Cancel new folder":"+ Create new folder"})}),c&&l&&i&&(0,a.jsxs)("div",{className:"mb-4 p-4 border border-gray-200 dark:border-gray-700 rounded-lg bg-gray-50 dark:bg-gray-700/40 space-y-3",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-gray-500 dark:text-gray-300 mb-2",children:"Folder name"}),a.jsx("input",{type:"text",value:u,onChange:e=>m(e.target.value),className:"w-full px-3 py-2 text-sm rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"e.g., Biology"})]}),(0,a.jsxs)("div",{children:[a.jsx("span",{className:"block text-xs font-semibold text-gray-500 dark:text-gray-300 mb-2",children:"Color"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:n.map(e=>a.jsx("button",{type:"button",onClick:()=>p(e),className:`w-7 h-7 rounded-full border-2 ${g===e?"border-gray-900 dark:border-white":"border-transparent"} focus:outline-none transition-transform hover:scale-105`,style:{backgroundColor:e},"aria-label":`Select ${e} color`},e))})]}),f&&a.jsx("p",{className:"text-xs text-red-500",children:f}),(0,a.jsxs)("div",{className:"flex justify-end space-x-2",children:[a.jsx("button",{onClick:()=>{x(!1),m(""),b(null)},className:"px-3 py-2 text-sm text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-gray-100",disabled:y,children:"Cancel"}),a.jsx("button",{onClick:k,disabled:y,className:"px-3 py-2 text-sm rounded-lg bg-primary-600 text-white hover:bg-primary-700 transition-colors disabled:opacity-60 disabled:cursor-not-allowed",children:y?"Creating...":"Create & use folder"})]})]}),!l&&a.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-3",children:"Folder limit reached. Delete an existing folder to add a new one."}),(0,a.jsxs)("div",{className:"space-y-2 max-h-64 overflow-y-auto pr-1",children:[(0,a.jsxs)("button",{onClick:()=>o(null),className:"w-full flex items-center px-3 py-2 rounded-lg border border-transparent hover:border-primary-200 hover:bg-primary-50 dark:hover:bg-primary-900/20 transition-colors",children:[a.jsx("span",{className:"w-3 h-3 rounded-full bg-gray-400 dark:bg-gray-500 mr-3"}),a.jsx("span",{className:"text-left text-sm text-gray-900 dark:text-gray-100",children:"All notes"})]}),r.map(e=>(0,a.jsxs)("button",{onClick:()=>o(e.id),className:"w-full flex items-center px-3 py-2 rounded-lg border border-transparent hover:border-primary-200 hover:bg-primary-50 dark:hover:bg-primary-900/20 transition-colors",children:[a.jsx("span",{className:"w-3 h-3 rounded-full mr-3",style:{backgroundColor:e.color}}),a.jsx("span",{className:"text-left text-sm text-gray-900 dark:text-gray-100",children:e.name})]},e.id))]}),a.jsx("div",{className:"mt-6 flex justify-end",children:a.jsx("button",{onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-gray-100",children:"Cancel"})})]})}):null}let g=["#991b1b","#ef4444","#f97316","#eab308","#22c55e","#3b82f6","#a855f7","#ec4899","#92400e","#6b7280"],p=()=>"undefined"!=typeof crypto&&"function"==typeof crypto.randomUUID?crypto.randomUUID():`${Date.now()}-${Math.random().toString(16).slice(2)}`;function y(){let[e,r]=(0,s.useState)(!0),[t,y]=(0,s.useState)([]),[h,f]=(0,s.useState)(!0),[b,k]=(0,s.useState)(""),[j,v]=(0,s.useState)(null),[w,N]=(0,s.useState)([]),[C,S]=(0,s.useState)(null),[D,_]=(0,s.useState)("upload"),[F,O]=(0,s.useState)([]),[P,$]=(0,s.useState)(""),[A,E]=(0,s.useState)(!1),[z,L]=(0,s.useState)([]),[U,T]=(0,s.useState)(!1),[M,B]=(0,s.useState)([]),[I,W]=(0,s.useState)([]),[q,R]=(0,s.useState)(""),[V,H]=(0,s.useState)(""),[J,G]=(0,s.useState)(""),[X,Y]=(0,s.useState)(!1),[K,Q]=(0,s.useState)(null),[Z,ee]=(0,s.useState)(!1),[er,et]=(0,s.useState)(null),[ea,es]=(0,s.useState)({isOpen:!1,noteId:null,noteTitle:""}),[eo,el]=(0,s.useState)(!1),[en,ei]=(0,s.useState)({isOpen:!1,file:null,pendingUpload:null}),[ed,ec]=(0,s.useState)(!1),[ex,eu]=(0,s.useState)(""),[em,eg]=(0,s.useState)(g[0]),[ep,ey]=(0,s.useState)(!1),[eh,ef]=(0,s.useState)(null),[eb,ek]=(0,s.useState)({isOpen:!1,folder:null}),[ej,ev]=(0,s.useState)(null),[ew,eN]=(0,s.useState)(""),[eC,eS]=(0,s.useState)(!1),[eD,e_]=(0,s.useState)(!1),[eF,eO]=(0,s.useState)(!1),[eP,e$]=(0,s.useState)(!1),[eA,eE]=(0,s.useState)([]);(0,o.useRouter)();let{user:ez,loading:eL}=(0,l.a)(),eU=(0,s.useRef)(null),eT=(0,s.useRef)(null),eM=w.length<10,eB=(0,s.useMemo)(()=>C?w.find(e=>e.id===C)??null:null,[w,C]),eI=(0,s.useCallback)(async e=>{try{let{data:{session:e},error:r}=await n.O.auth.getSession();if(r||!e?.access_token)throw Error("Unauthorized");let t=await fetch("/api/folders",{headers:{Authorization:`Bearer ${e.access_token}`}});if(!t.ok)throw Error("Failed to fetch folders");let a=await t.json()??[];N(a),S(e=>e?a.some(r=>r.id===e)?e:null:e),a.length>=10&&ec(!1)}catch(e){console.error("Error fetching folders:",e),N([])}},[]),eW=async e=>{if(ez){eO(!0);try{let{data:{session:r},error:t}=await n.O.auth.getSession();if(t||!r?.access_token)throw Error("Unauthorized");if(!(await fetch(`/api/folders/${e.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${r.access_token}`}})).ok)throw Error("Failed to delete folder");N(r=>r.filter(r=>r.id!==e.id)),C===e.id&&S(null),ed&&w.length-1<10&&ec(!1)}catch(e){console.error("Failed to delete folder:",e),alert("Failed to delete folder. Please try again.")}finally{eO(!1),ek({isOpen:!1,folder:null})}}},eq=(e,r)=>{e.preventDefault(),ef({x:e.clientX,y:e.clientY,folder:r})},eR=e=>{ev(e.id),eN(e.name),eS(!0),e_(!1),ef(null)},eV=()=>{eD||(ev(null),eN(""),eS(!1))},eH=async e=>{if(e?.preventDefault(),ej&&ew.trim()&&ez){e_(!0);try{let{data:{session:e},error:r}=await n.O.auth.getSession();if(r||!e?.access_token)throw Error("Unauthorized");let t=await fetch(`/api/folders/${ej}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e.access_token}`},body:JSON.stringify({name:ew.trim()})});if(!t.ok)throw Error("Folder rename failed");let a=await t.json();N(e=>e.map(e=>e.id===ej?a:e)),C===ej&&S(a.id),eV()}catch(e){console.error("Failed to rename folder:",e),alert("Failed to rename folder. Please try again.")}finally{e_(!1)}}},eJ=(0,s.useCallback)(async e=>{try{let{data:{session:e},error:r}=await n.O.auth.getSession();if(r||!e?.access_token)throw Error("Unauthorized");let t=await fetch("/api/notes",{headers:{Authorization:`Bearer ${e.access_token}`}});if(!t.ok)throw Error("Failed to fetch notes");let a=await t.json()??[];y(a),v(e=>e&&a.some(r=>r.id===e.id)?e:a[0]??null);let s=new Set;a.forEach(e=>{e.tags?.forEach(e=>s.add(e))}),W(Array.from(s).sort())}catch(e){console.error("Error fetching notes:",e),y([]),W([]),v(null)}finally{f(!1)}},[]),eG=(0,s.useMemo)(()=>t.filter(e=>{let r=e.title.toLowerCase().includes(b.toLowerCase())||e.content&&e.content.toLowerCase().includes(b.toLowerCase())||e.tags&&e.tags.some(e=>e.toLowerCase().includes(b.toLowerCase())),t=0===M.length||e.tags&&M.every(r=>e.tags?.includes(r)),a=!C||e.folder_id===C;return r&&t&&a}),[t,b,M,C]),eX=e=>{if(S(e),!e){v(e=>e&&t.some(r=>r.id===e.id)?e:t[0]??null);return}v(t.find(r=>r.folder_id===e)??null)},eY=async()=>{if(ez&&ex.trim()&&eM){ey(!0);try{let{data:{session:e},error:r}=await n.O.auth.getSession();if(r||!e?.access_token)throw Error("Unauthorized");let t=await fetch("/api/folders",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e.access_token}`},body:JSON.stringify({name:ex.trim(),color:em})});if(!t.ok)throw Error("Failed to create folder");let a=await t.json();N(e=>[...e,a]),ec(!1),eu(""),eg(g[0]),S(a.id)}catch(e){console.error("Error creating folder:",e),alert("Failed to create folder. Please try again.")}finally{ey(!1)}}},eK=async(e,r)=>{if(!ez||!e.trim()||!eM)return null;try{let{data:{session:t},error:a}=await n.O.auth.getSession();if(a||!t?.access_token)throw Error("Unauthorized");let s=await fetch("/api/folders",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t.access_token}`},body:JSON.stringify({name:e.trim(),color:r})});if(!s.ok)return null;let o=await s.json();return N(e=>[...e,o]),{id:o.id,name:o.name,color:o.color}}catch(e){return console.error("Upload create folder error:",e),null}},eQ=e=>{0!==e.length&&(eE(e),e$(!0))},eZ=async(e,r)=>{if(0===e.length)return;let{data:{session:t},error:a}=await n.O.auth.getSession();if(a||!t?.access_token){console.error("No active session found for upload",a),alert("Your session has expired. Please sign in again to upload files.");return}let s=t.access_token,o=r??null;for(let r=0;r<e.length;r++){let t=e[r];if(!["application/pdf","application/vnd.openxmlformats-officedocument.wordprocessingml.document"].includes(t.type)){alert(`${t.name} is not supported. Only PDF and DOCX files are currently supported.`);continue}if(t.size>1048576){await new Promise(e=>{ei({isOpen:!0,file:t,pendingUpload:()=>{ei({isOpen:!1,file:null,pendingUpload:null}),e0(t,s,r,!0,o),e()}})});continue}await e0(t,s,r,!1,o)}},e0=async(e,r,t,a,s)=>{let o={id:Date.now().toString()+t,name:e.name,type:e.type,size:e.size,url:URL.createObjectURL(e),status:"uploading"};L(e=>[...e,o]);try{let t=new FormData;t.append("file",e),t.append("title",e.name.replace(/\.(pdf|docx)$/i,"")),a&&t.append("skipAI","true"),s&&t.append("folder_id",s);let l=await fetch("/api/notes/upload",{method:"POST",body:t,credentials:"include",headers:{Authorization:`Bearer ${r}`}}),n=null;if(l.headers.get("content-type")?.includes("application/json"))try{n=await l.json()}catch(e){console.error("Failed to parse upload response as JSON",e)}if(!l.ok){let e=n?.error||`Upload failed (status ${l.status})`;throw Error(e)}L(e=>e.map(e=>e.id===o.id?{...e,status:"completed",summary:"File uploaded and text extracted successfully!"}:e)),ez&&await eJ(ez),setTimeout(()=>{L(e=>e.filter(e=>e.id!==o.id))},2e3)}catch(r){console.error("Upload error:",r),L(e=>e.map(e=>e.id===o.id?{...e,status:"error"}:e)),alert(`Failed to upload ${e.name}: ${r instanceof Error?r.message:"Unknown error"}`)}},e2=async()=>{if(ez&&q.trim()){Y(!0);try{let e=J.split(",").map(e=>e.trim()).filter(e=>e.length>0),{data:{session:r},error:t}=await n.O.auth.getSession();if(t||!r?.access_token)throw Error("Unauthorized");let a=await fetch("/api/notes",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r.access_token}`},body:JSON.stringify({title:q.trim(),content:V.trim()||null,tags:e.length>0?e:null,folder_id:C??null})});if(!a.ok)throw Error("Failed to create note");let s=await a.json();R(""),H(""),G(""),await eJ(ez),s&&v(s)}catch(e){console.error("Error creating note:",e),alert("Failed to create note. Please try again.")}finally{Y(!1)}}},e1=e=>{Q(e),ee(!0)},e4=(e,r)=>{e.preventDefault(),et({x:e.clientX,y:e.clientY,noteId:r})},e3=async(e,r)=>{if(!ez)return;let a=t.find(r=>r.id===e);if(!a||a.folder_id===r){et(null);return}try{let{data:{session:t},error:a}=await n.O.auth.getSession();if(a||!t?.access_token)throw Error("Unauthorized");if(!(await fetch(`/api/notes/${e}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t.access_token}`},body:JSON.stringify({folder_id:r})})).ok)throw Error("Failed to move note");y(t=>t.map(t=>t.id===e?{...t,folder_id:r}:t)),v(t=>t&&t.id===e?{...t,folder_id:r}:t),Q(t=>t&&t.id===e?{...t,folder_id:r}:t),C&&r!==C&&v(r=>r&&r.id===e?null:r),et(null),ez&&eI(ez)}catch(e){console.error("Failed to move note:",e),alert("Failed to move note. Please try again.")}},e6=e=>{let r=t.find(r=>r.id===e);r&&(es({isOpen:!0,noteId:e,noteTitle:r.title}),et(null))},e5=async()=>{if(ea.noteId&&ez){el(!0);try{let{data:{session:e},error:r}=await n.O.auth.getSession();if(r||!e?.access_token)throw Error("Unauthorized");if(!(await fetch(`/api/notes/${ea.noteId}`,{method:"DELETE",headers:{Authorization:`Bearer ${e.access_token}`}})).ok)throw Error("Delete failed");K?.id===ea.noteId&&(ee(!1),Q(null)),await eJ(ez),es({isOpen:!1,noteId:null,noteTitle:""})}catch(e){console.error("Delete failed:",e),alert("Failed to delete note. Please try again.")}finally{el(!1)}}},e7=async()=>{if(!P.trim()||A)return;let e={id:p(),type:"user",content:P,timestamp:new Date().toISOString(),noteId:j?.id},r=[...F,e].map(e=>({role:"user"===e.type?"user":"assistant",content:e.content}));O(r=>[...r,e]),$(""),E(!0);try{let{data:{session:e},error:t}=await n.O.auth.getSession();if(t||!e?.access_token)throw Error("You must be signed in to use the AI assistant. Please log in again.");let a=await fetch("/api/notes/chat",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e.access_token}`},credentials:"include",body:JSON.stringify({messages:r,noteIds:j?[j.id]:void 0})}),s=await a.json().catch(()=>null);if(!a.ok)throw Error(s?.error??"Chat request failed");let o={id:p(),type:"ai",content:s?.message??"No response generated.",timestamp:new Date().toISOString(),noteId:j?.id,sources:Array.isArray(s?.sources)?s.sources:void 0};O(e=>[...e,o])}catch(r){console.error("Chat error:",r);let e={id:p(),type:"ai",content:r instanceof Error?r.message:"Failed to generate response. Please try again.",timestamp:new Date().toISOString(),noteId:j?.id};O(r=>[...r,e])}finally{E(!1)}},e9=e=>e.includes("pdf")?"\uD83D\uDCC4":e.includes("audio")?"\uD83C\uDFB5":e.includes("image")?"\uD83D\uDDBC️":e.includes("video")?"\uD83C\uDFA5":"\uD83D\uDCC4",e8=e=>{switch(e){case"completed":return"text-green-600";case"processing":return"text-yellow-600";case"uploading":return"text-blue-600";case"error":return"text-red-600";default:return"text-gray-600"}};return h?a.jsx("div",{className:"flex items-center justify-center min-h-96",children:a.jsx("div",{className:"text-lg",children:"Loading notes..."})}):(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100",children:"Notes"}),a.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"Create, manage, and organize your study notes"}),!e&&(0,a.jsxs)("div",{className:"mt-3 inline-flex items-center space-x-2 rounded-full bg-primary-50 text-primary-700 px-3 py-1 text-xs font-medium dark:bg-primary-900/30 dark:text-primary-200",children:[a.jsx("span",{className:"inline-flex h-2.5 w-2.5 rounded-full border border-primary-200 dark:border-primary-700",style:{backgroundColor:eB?.color??"#9ca3af"}}),(0,a.jsxs)("span",{children:["Viewing: ",eB?.name??"All notes"]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[a.jsx("button",{onClick:()=>eT.current?.click(),className:"bg-primary-600 text-white px-4 py-2 rounded-lg hover:bg-primary-700 transition-colors",children:"Upload Files"}),a.jsx("button",{className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors",onClick:()=>{S(null),r(!0),window.scrollTo({top:0,behavior:"smooth"})},children:"Create Note"}),a.jsx("input",{type:"file",multiple:!0,ref:eT,className:"hidden",accept:".pdf,.docx",onChange:e=>{let{files:r}=e.target;r&&0!==r.length&&(eQ(Array.from(r)),e.target.value="")}})]})]}),(0,a.jsxs)("div",{className:"flex pt-6",children:[(0,a.jsxs)("div",{className:`${e?"w-80":"w-12"} bg-white dark:bg-gray-800 shadow-lg rounded-lg transition-all duration-300 flex flex-col border-r border-gray-200 dark:border-gray-700`,children:[(0,a.jsxs)("div",{className:`p-2 border-b border-gray-200 dark:border-gray-700 flex items-center ${e?"justify-between pl-2 pr-2":"justify-center"}`,children:[a.jsx("h2",{className:`font-semibold text-gray-900 dark:text-gray-100 ${e?"pl-1":"hidden"}`,children:"Saved Notes"}),a.jsx("button",{onClick:()=>r(!e),className:`rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors ${e?"p-2":"p-3"}`,title:e?"Collapse sidebar":"Expand sidebar",children:a.jsx("svg",{className:"w-5 h-5 text-gray-600 dark:text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e?a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 19l-7-7 7-7m8 14l-7-7 7-7"}):a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 5l7 7-7 7M5 5l7 7-7 7"})})})]}),e&&(0,a.jsxs)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide text-gray-500 dark:text-gray-400",children:"Folders"}),(0,a.jsxs)("button",{onClick:()=>{eM&&ec(e=>!e)},disabled:!eM,className:`inline-flex items-center px-2 py-1 text-xs font-medium rounded-md transition-colors relative group ${eM?"text-primary-600 dark:text-primary-300 bg-primary-50 dark:bg-primary-900/20 hover:bg-primary-100 dark:hover:bg-primary-900/40":"text-gray-400 dark:text-gray-500 bg-gray-100 dark:bg-gray-700 cursor-not-allowed"}`,children:[ed?"Cancel":"+ New",!eM&&a.jsx("span",{className:"pointer-events-none absolute left-1/2 top-full mt-2 -translate-x-1/2 whitespace-nowrap rounded bg-gray-800 px-2 py-1 text-[10px] font-medium text-white opacity-0 group-hover:opacity-100 transition-opacity",children:"Folder limit reached. Delete an existing folder to add a new one."})]})]}),ed&&eM&&(0,a.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700/40 border border-gray-200 dark:border-gray-600 rounded-lg p-3 space-y-3",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs font-semibold text-gray-600 dark:text-gray-300 mb-2",children:"Folder name"}),a.jsx("input",{type:"text",value:ex,onChange:e=>eu(e.target.value),placeholder:"e.g. Biology",className:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100"})]}),(0,a.jsxs)("div",{children:[a.jsx("span",{className:"block text-xs font-semibold text-gray-600 dark:text-gray-300 mb-2",children:"Color"}),a.jsx("div",{className:"grid grid-cols-5 gap-2",children:g.map(e=>a.jsx("button",{type:"button",onClick:()=>eg(e),className:`w-7 h-7 rounded-full border-2 ${em===e?"border-gray-900 dark:border-white":"border-transparent"} focus:outline-none transition-transform hover:scale-105`,style:{backgroundColor:e},"aria-label":`Select ${e} color`},e))})]}),a.jsx("button",{onClick:eY,disabled:ep||0===ex.trim().length,className:"w-full inline-flex items-center justify-center px-3 py-2 text-sm font-medium rounded-lg bg-primary-600 text-white hover:bg-primary-700 transition-colors disabled:opacity-60 disabled:cursor-not-allowed",children:ep?"Creating...":"Create folder"})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("button",{onClick:()=>eX(null),className:`w-full flex items-center px-3 py-2 rounded-lg text-sm transition-colors ${null===C?"bg-primary-100 dark:bg-primary-900/30 text-primary-700 dark:text-primary-200":"hover:bg-gray-100 dark:hover:bg-gray-700/50 text-gray-700 dark:text-gray-200"}`,children:[a.jsx("span",{className:"w-2.5 h-2.5 rounded-full bg-gray-400 dark:bg-gray-500 mr-3"}),a.jsx("span",{className:"flex-1 text-left",children:"All notes"})]}),0===w.length&&!ed&&a.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 px-1 py-2",children:"No folders yet. Create one to get started."}),w.map(e=>ej===e.id?(0,a.jsxs)("form",{onSubmit:eH,className:"w-full px-3 py-2 rounded-lg bg-primary-50 dark:bg-primary-900/20 border border-primary-200 dark:border-primary-700 space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"w-2.5 h-2.5 rounded-full",style:{backgroundColor:e.color}}),a.jsx("input",{ref:eU,value:ew,onChange:e=>eN(e.target.value),onKeyDown:e=>{"Escape"===e.key&&eV()},className:"flex-1 bg-transparent border border-gray-300 dark:border-gray-600 rounded-lg px-2 py-1 text-sm text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Folder name",disabled:eD})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-2",children:[a.jsx("button",{type:"button",onClick:eV,className:"px-2 py-1 text-xs text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-gray-100",disabled:eD,children:"Cancel"}),a.jsx("button",{type:"submit",className:"px-3 py-1 text-xs rounded-lg bg-primary-600 text-white hover:bg-primary-700 transition-colors disabled:opacity-60 disabled:cursor-not-allowed",disabled:eD||0===ew.trim().length,children:eD?"Saving...":"Save"})]})]},e.id):(0,a.jsxs)("button",{onClick:()=>eX(e.id),onContextMenu:r=>eq(r,e),className:`w-full flex items-center px-3 py-2 rounded-lg text-sm transition-colors ${C===e.id?"bg-primary-100 dark:bg-primary-900/30 text-primary-700 dark:text-primary-200":"hover:bg-gray-100 dark:hover:bg-gray-700/50 text-gray-700 dark:text-gray-200"}`,children:[a.jsx("span",{className:"w-2.5 h-2.5 rounded-full mr-3",style:{backgroundColor:e.color}}),a.jsx("span",{className:"flex-1 text-left truncate",children:e.name}),C===e.id&&a.jsx("svg",{className:"w-4 h-4 text-primary-600 dark:text-primary-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})]},e.id))]})]}),e&&a.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:a.jsx("input",{type:"text",placeholder:"Search notes...",className:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",value:b,onChange:e=>k(e.target.value)})}),a.jsx("div",{className:`flex-1 overflow-y-auto ${!e&&"hidden"}`,children:0===eG.length?a.jsx("div",{className:"p-4 text-center text-gray-500 dark:text-gray-400",children:e?(0,a.jsxs)("div",{children:[a.jsx("svg",{className:"mx-auto h-8 w-8 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),a.jsx("p",{className:"text-sm",children:"No notes yet"})]}):a.jsx("svg",{className:"mx-auto h-8 w-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}):a.jsx("div",{className:"p-2",children:eG.map(r=>{let t=r.folder_id?w.find(e=>e.id===r.folder_id)?.color??"#9ca3af":null;return(0,a.jsxs)("div",{onClick:()=>e1(r),onContextMenu:e=>e4(e,r.id),className:`p-3 rounded-lg cursor-pointer transition-colors mb-2 ${j?.id===r.id?"bg-gray-100 dark:bg-gray-700 border border-gray-300 dark:border-gray-600":"hover:bg-gray-50 dark:hover:bg-gray-700/30"}`,children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[t&&a.jsx("span",{className:"inline-flex h-2.5 w-2.5 rounded-full border border-gray-200 dark:border-gray-600",style:{backgroundColor:t},"aria-hidden":!0}),a.jsx("h3",{className:`font-medium text-gray-900 dark:text-gray-100 line-clamp-1 ${!e&&"hidden"}`,children:r.title})]}),a.jsx("p",{className:`text-sm text-gray-600 dark:text-gray-300 line-clamp-2 mt-1 ${!e&&"hidden"}`,children:r.content}),a.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:new Date(r.updated_at).toLocaleDateString()})]},r.id)})})})]}),(0,a.jsxs)("div",{className:"flex-1 pl-6 space-y-8",children:[(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Recent Files"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[eG.slice(0,4).map(e=>(0,a.jsxs)("div",{className:"p-4 border border-gray-200 dark:border-gray-600 rounded-lg hover:shadow-md transition-shadow cursor-pointer",onClick:()=>e1(e),onContextMenu:r=>e4(r,e.id),children:[(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[a.jsx("svg",{className:"w-5 h-5 text-gray-400 dark:text-gray-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),a.jsx("h3",{className:"font-medium text-gray-900 dark:text-gray-100 line-clamp-1",children:e.title})]}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 line-clamp-2",children:e.content}),a.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:new Date(e.updated_at).toLocaleDateString()})]},e.id)),0===eG.length&&(0,a.jsxs)("div",{className:"col-span-full text-center py-8 text-gray-500 dark:text-gray-400",children:[a.jsx("svg",{className:"mx-auto h-12 w-12 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),a.jsx("p",{children:"No recent files"})]})]})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Create Notes Manually"}),a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Craft a new note by hand and save it to your collection."})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[a.jsx("button",{onClick:()=>{R(""),H("")},className:"px-3 py-2 text-sm rounded-lg border border-gray-200 dark:border-gray-600 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:"Clear"}),a.jsx("button",{onClick:e2,disabled:!q.trim()||X,className:"px-4 py-2 text-sm rounded-lg bg-primary-600 text-white hover:bg-primary-700 transition-colors disabled:opacity-60 disabled:cursor-not-allowed",children:X?"Saving...":"Save note"})]})]}),(0,a.jsxs)("div",{className:"space-y-4 max-w-3xl",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Note Title"}),a.jsx("input",{type:"text",value:q,onChange:e=>R(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",placeholder:"Enter note title..."})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Content"}),a.jsx("textarea",{rows:8,value:V,onChange:e=>H(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",placeholder:"Write your note content here..."})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Assign to folder"}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[a.jsx("button",{type:"button",onClick:()=>S(null),className:`px-3 py-1.5 text-sm rounded-full border ${null===C?"border-primary-500 bg-primary-50 text-primary-600 dark:bg-primary-900/20 dark:text-primary-200":"border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-300 hover:border-primary-400"}`,children:"All notes"}),w.map(e=>a.jsx("button",{type:"button",onClick:()=>S(e.id),className:`px-3 py-1.5 text-sm rounded-full border ${C===e.id?"border-primary-500 bg-primary-50 text-primary-600 dark:bg-primary-900/20 dark:text-primary-200":"border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-300 hover:border-primary-400"}`,children:(0,a.jsxs)("span",{className:"inline-flex items-center space-x-2",children:[a.jsx("span",{className:"inline-block w-2.5 h-2.5 rounded-full",style:{backgroundColor:e.color}}),a.jsx("span",{children:e.name})]})},e.id))]})]})]})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Upload Files"}),(0,a.jsxs)("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-8 text-center",onDragOver:e=>e.preventDefault(),onDrop:e=>{e.preventDefault(),e.dataTransfer.files&&eQ(Array.from(e.dataTransfer.files))},children:[a.jsx("div",{className:"text-4xl mb-4",children:"\uD83E\uDD16"}),a.jsx("p",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:"AI-Enhanced Processing"}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mb-4",children:"Upload files for automatic transcription, summarization, and smart tagging"}),a.jsx("div",{className:"flex justify-center space-x-4",children:(0,a.jsxs)("label",{className:"bg-primary-600 text-white px-6 py-3 rounded-lg hover:bg-primary-700 transition-colors cursor-pointer",children:["Choose Files",a.jsx("input",{type:"file",multiple:!0,className:"hidden",accept:".pdf,.docx",onChange:e=>{e.target.files&&(eQ(Array.from(e.target.files)),e.target.value="")}})]})}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-4",children:[a.jsx("p",{className:"font-medium mb-1",children:"PDF & DOCX files • Max 10MB"}),a.jsx("p",{className:"text-yellow-600 dark:text-yellow-400",children:"⚠️ Files under 1MB recommended for AI features"}),a.jsx("p",{className:"mt-2",children:"\uD83D\uDCC4 Text extraction • \uD83D\uDD0D AI-powered search • \uD83C\uDFF7️ Smart organization"})]})]}),z.length>0&&(0,a.jsxs)("div",{className:"mt-6",children:[a.jsx("h3",{className:"font-medium text-gray-900 dark:text-gray-100 mb-3",children:"Processing Queue"}),a.jsx("div",{className:"space-y-2",children:z.map(e=>(0,a.jsxs)("div",{className:"flex items-center p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[a.jsx("div",{className:"text-xl mr-3",children:e9(e.type)}),(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100",children:e.name}),a.jsx("div",{className:`text-xs ${e8(e.status)}`,children:"completed"===e.status?"✅ AI Processing Complete":"\uD83E\uDD16 Processing..."})]})]},e.id))})]})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[(0,a.jsxs)("div",{className:"flex items-center mb-4",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"AI Study Assistant"}),a.jsx("div",{className:"ml-2 bg-gradient-to-r from-purple-500 to-pink-500 text-white text-xs px-2 py-1 rounded-full",children:"AI"})]}),(0,a.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 mb-4 h-64 overflow-y-auto",children:[0===F.length?(0,a.jsxs)("div",{className:"text-center text-gray-500 dark:text-gray-400 py-8",children:[a.jsx("div",{className:"text-4xl mb-4",children:"\uD83E\uDD16"}),a.jsx("p",{children:"Ask me anything about your notes!"})]}):a.jsx("div",{className:"space-y-3",children:F.slice(-5).map(e=>a.jsx("div",{className:`flex ${"user"===e.type?"justify-end":"justify-start"}`,children:(0,a.jsxs)("div",{className:`max-w-xs px-3 py-2 rounded-lg text-sm ${"user"===e.type?"bg-primary-600 text-white":"bg-white dark:bg-gray-600 border border-gray-200 dark:border-gray-600 text-gray-900 dark:text-gray-100"}`,children:[a.jsx("p",{className:"whitespace-pre-line",children:e.content}),e.sources&&e.sources.length>0&&(0,a.jsxs)("div",{className:"mt-2 border-t border-gray-200 dark:border-gray-500 pt-2",children:[a.jsx("p",{className:"text-xs font-semibold text-gray-600 dark:text-gray-300 mb-1",children:"Sources"}),a.jsx("ul",{className:"text-xs text-gray-600 dark:text-gray-200 space-y-1",children:e.sources.map(e=>(0,a.jsxs)("li",{className:"flex items-start space-x-1",children:[a.jsx("span",{children:"•"}),a.jsx("span",{children:e.title})]},e.id))})]})]})},e.id))}),A&&a.jsx("div",{className:"mt-4 flex justify-start text-sm text-gray-500 dark:text-gray-300",children:"Thinking..."})]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[a.jsx("input",{type:"text",value:P,onChange:e=>$(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),e7())},placeholder:"Ask about your notes...",className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",disabled:A}),a.jsx("button",{onClick:()=>{e7()},disabled:A||!P.trim(),className:"bg-primary-600 text-white px-4 py-2 rounded-lg hover:bg-primary-700 transition-colors disabled:opacity-60 disabled:cursor-not-allowed",children:A?"Sending...":"Send"})]})]})]})]}),a.jsx(m,{isOpen:eP,folders:w.map(e=>({id:e.id,name:e.name,color:e.color})),onCancel:()=>{e$(!1),eE([])},onSelectFolder:e=>{if(0===eA.length){e$(!1);return}eZ(eA,e),e$(!1),eE([])},canCreateFolder:w.length<10,folderColors:g,onCreateFolder:w.length<10?eK:void 0}),eh&&a.jsx(u,{x:eh.x,y:eh.y,onClose:()=>ef(null),onRename:()=>eR(eh.folder),onDelete:()=>{ek({isOpen:!0,folder:eh.folder}),ef(null)}}),a.jsx(c.Q,{isOpen:eb.isOpen,title:"Delete Folder",message:eb.folder?`Are you sure you want to delete the folder "${eb.folder.name}"? Notes inside will remain accessible under All notes.`:"",confirmText:eF?"Deleting...":"Delete",cancelText:"Cancel",onConfirm:()=>{eb.folder&&eW(eb.folder)},onCancel:()=>{eF||ek({isOpen:!1,folder:null})},isDestructive:!0}),a.jsx(i.t,{note:K,isOpen:Z,onClose:()=>{ee(!1),Q(null)},onDeleted:()=>{ee(!1),Q(null),ez&&(eJ(ez),eI(ez))},folders:w,onUpdated:e=>{y(r=>r.map(r=>r.id===e.id?{...r,folder_id:e.folder_id}:r)),Q(r=>r&&r.id===e.id?{...r,folder_id:e.folder_id}:r),C&&e.folder_id!==C&&v(r=>r&&r.id===e.id?null:r),ez&&(eJ(ez),eI(ez))}}),er&&a.jsx(d.L,{x:er.x,y:er.y,onDelete:()=>e6(er.noteId),onClose:()=>et(null),folders:w,currentFolderId:t.find(e=>e.id===er.noteId)?.folder_id??null,onMove:e=>e3(er.noteId,e)}),a.jsx(c.Q,{isOpen:ea.isOpen,title:"Delete note?",message:`Are you sure you want to delete "${ea.noteTitle}"? This action cannot be undone.`,confirmText:eo?"Deleting...":"Delete",cancelText:"Cancel",onConfirm:e5,onCancel:()=>es({isOpen:!1,noteId:null,noteTitle:""}),isDestructive:!0}),a.jsx(x,{isOpen:en.isOpen,fileName:en.file?.name??"",fileSize:en.file?.size??0,maxSize:1048576,onConfirm:()=>{en.pendingUpload&&en.pendingUpload()},onCancel:()=>{ei({isOpen:!1,file:null,pendingUpload:null})}})]})}},524:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>a});let a=(0,t(8570).createProxy)(String.raw`C:\Users\owenr\Desktop\Windsurf Projects\Study_Sharper_Complete\Study_Sharper_Frontend\src\app\notes\page.tsx#default`)}};var r=require("../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[276,688,375,860],()=>t(4442));module.exports=a})();